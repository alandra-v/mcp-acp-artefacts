{
  "$defs": {
    "OIDCInfo": {
      "description": "Details about the OIDC/OAuth token and provider, for authentication logs.",
      "properties": {
        "issuer": {
          "title": "Issuer",
          "type": "string"
        },
        "provider": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Provider"
        },
        "client_id": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Client Id"
        },
        "audience": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Audience"
        },
        "scopes": {
          "anyOf": [
            {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Scopes"
        },
        "token_type": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Token Type"
        },
        "token_exp": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Token Exp"
        },
        "token_iat": {
          "anyOf": [
            {
              "format": "date-time",
              "type": "string"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Token Iat"
        },
        "token_expired": {
          "anyOf": [
            {
              "type": "boolean"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Token Expired"
        }
      },
      "required": [
        "issuer"
      ],
      "title": "OIDCInfo",
      "type": "object"
    },
    "SubjectIdentity": {
      "description": "Identity of the human user, derived from the OIDC token.",
      "properties": {
        "subject_id": {
          "title": "Subject Id",
          "type": "string"
        },
        "subject_claims": {
          "anyOf": [
            {
              "additionalProperties": {
                "type": "string"
              },
              "type": "object"
            },
            {
              "type": "null"
            }
          ],
          "default": null,
          "title": "Subject Claims"
        }
      },
      "required": [
        "subject_id"
      ],
      "title": "SubjectIdentity",
      "type": "object"
    }
  },
  "additionalProperties": false,
  "description": "One authentication/authorization log entry (logs/audit/auth.jsonl).\n\nInspired by:\n  - OCSF Authentication (3002): token validation outcome, identity, IdP context\n  - OCSF Authorize Session (3003): session lifecycle (start/stop) tied to identity",
  "properties": {
    "time": {
      "format": "date-time",
      "title": "Time",
      "type": "string"
    },
    "session_id": {
      "title": "Session Id",
      "type": "string"
    },
    "request_id": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Request Id"
    },
    "event_type": {
      "enum": [
        "token_validated",
        "token_invalid",
        "session_started",
        "session_ended"
      ],
      "title": "Event Type",
      "type": "string"
    },
    "status": {
      "enum": [
        "Success",
        "Failure"
      ],
      "title": "Status",
      "type": "string"
    },
    "message": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Message"
    },
    "method": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Method"
    },
    "subject": {
      "anyOf": [
        {
          "$ref": "#/$defs/SubjectIdentity"
        },
        {
          "type": "null"
        }
      ],
      "default": null
    },
    "oidc": {
      "anyOf": [
        {
          "$ref": "#/$defs/OIDCInfo"
        },
        {
          "type": "null"
        }
      ],
      "default": null
    },
    "error_type": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Error Type"
    },
    "error_message": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Error Message"
    },
    "details": {
      "anyOf": [
        {
          "additionalProperties": true,
          "type": "object"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "title": "Details"
    }
  },
  "required": [
    "time",
    "session_id",
    "event_type",
    "status"
  ],
  "title": "AuthEvent",
  "type": "object"
}
